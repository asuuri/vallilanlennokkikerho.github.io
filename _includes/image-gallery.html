<style>
    .image-gallery {
        overflow: auto;
        margin-left: -1%!important;
    }
    .image-gallery li {
        float: left;
        display: block;
        margin: 0 0 1% 1%;
        width: 19%;
        aspect-ratio: 1;
    }
    .image-gallery li a {
        text-align: center;
        text-decoration: none!important;
        color: #777;
        display: block;
        height: 100%;
        position: relative;
    }
    .image-gallery li a span {
        display: block;
        text-overflow: ellipsis;
        overflow: hidden;
        white-space: nowrap;
        padding: 3px 0;
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background: rgba(255,255,255,0.9);
    }
    .image-gallery li a img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
        background: #f0f0f0;
    }
</style>

<ul class="image-gallery">
  {% for file in site.static_files %}
    {% if file.path contains include.folder %}
      {% if file.extname == '.jpg' or file.extname == '.jpeg' or file.extname == '.JPG' or file.extname == '.JPEG' %}
        {% assign filenameparts = file.path | split: "/" %}
        {% assign filename = filenameparts | last | replace: file.extname,"" %}
        <li>
          <a href="{{ file.path | relative_url }}" title="{{ filename }}">
            <img 
              loading="lazy"
              src="//images.weserv.nl/?url={{ site.url | replace: 'http://','' | replace: 'https://','' }}{{ file.path | relative_url }}&w=300&h=300&output=jpg&q=50&t=square" 
              alt="{{ filename }}" 
              title="{{ filename }}"
            />
            <span>{{ filename }}</span>
          </a>
        </li>
      {% endif %}
    {% endif %}
  {% endfor %}
</ul>